# Спецификация Darkwolf UID (DWUID)

&copy; 2023 Pavel Wolf <cyberviking@darkwolf.team>

## 1. Аннотация

Darkwolf UID (DWUID) — универсальный уникальный лексикографический хомосапиенс-френдли децентрализованный идентификатор, используемый для идентификации каких-либо сущностей или объектов реального мира.

## 2. Структура

DWUID представляет собой последовательность битов, состоящую из 4-битной версии и N-битного идентификатора, где N, в зависимости от версии, может быть постоянным или изменчивым.

Представление 24-битного DWUID, состоящего из 3 байтов:

`1XXXYYYY YYYYYYYY YYYYYYYY`

X — биты версии \
Y — биты идентификатора

## 3. Версии

На данный момент спецификация описывает 4 версии идентификатора.

### 3.1. Timestamp

Версия идентификатора на основе отметки времени с момента начала эпохи Unix в миллисекундах, с возможным дополнением уникальной последовательностью.

Timestamp версия DWUID представляет собой последовательность битов, состоящую из 4-битной версии, 48-битной отметки времени с момента начала эпохи Unix в миллисекундах и возможного дополнения N-битной уникальной последовательностью.

Рекомендуется использовать 68-битную уникальную последовательность для получения 120-битного DWUID, который будет иметь
постоянную длину, в зависимости от кодировки, 20-21 символ в текстовом представлении.

Представление Timestamp версии 120-битного DWUID, состоящего из 15 байт:
 
`1000XXXX XXXXXXXX XXXXXXXX XXXXXXXX XXXXXXXX XXXXXXXX XXXXYYYY YYYYYYYY YYYYYYYY YYYYYYYY YYYYYYYY YYYYYYYY YYYYYYYY YYYYYYYY YYYYYYYY`

X — биты отметки времени в миллисекундах \
Y — биты уникальной последовательности

### 3.2. Random

Версия идентификатора на основе 
криптографически стойкой случайной или псевдослучайной последовательности.

Random версия DWUID представляет собой последовательность битов, состоящую из 4-битной версии и N-битной случайной последовательности.

Рекомендуется использовать 116-битную случайную последовательность  для получения 120-битного DWUID, который будет иметь
постоянную длину, в зависимости от кодировки, 20-21 символ в текстовом представлении.

Представление Random версии 120-битного DWUID, состоящего из 15 байт:
 
`1001XXXX XXXXXXXX XXXXXXXX XXXXXXXX XXXXXXXX XXXXXXXX XXXXXXXX XXXXXXXX XXXXXXXX XXXXXXXX XXXXXXXX XXXXXXXX XXXXXXXX XXXXXXXX XXXXXXXX`

X — биты случайной последовательности

### 3.3. Geohash

Версия идентификатора на основе географических координат широты и долготы, представленных в виде одномерного пространства. 

Geohash версия DWUID представляет собой последовательность битов, состоящую из 4-битной версии и 56-битного представления одномерного пространства.

Эмпирическим методом было выявлено, что 56-битного представления одномерного пространства достаточно для кодирования, используя арифметику с плавающей запятой, географических координат широты и долготы с точностью до 6 знаков после запятой включительно.

Представление Geohash версии 60-битного DWUID, состоящего из 8 байт:

`1010XXXX XXXXXXXX XXXXXXXX XXXXXXXX XXXXXXXX XXXXXXXX XXXXXXXX XXXX0000`

X — биты представления одномерного пространства

### 3.4. Hash

Версия идентификатора на основе дайджеста, полученного с использованием алгоритма хеширования BLAKE3.

В разработке.

## 4. Кодировки

Кодировки, используемые в текстовом представлении DWUID, основаны на алфавитах с лексикографическим порядком символов.

### 4.1 Base58

Символы алфавита:

`123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz`

`I` и `l` — псевдонимы для `1` \
`0` и `O` — псевдонимы для `o`

### 4.2 Base64

Символы алфавита:

`-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz`